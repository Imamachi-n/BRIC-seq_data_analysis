#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
#for (x in 1:length(input_file[,1])){
for (x in 1:10){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
print(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
print(start_time)
print(exp(y))
print(exp(y)/start_time)
rel_exp <- append(rel_exp, exp(y)/start_time)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
#for (x in 1:length(input_file[,1])){
for (x in 1:10){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
print(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
print(y)
print(exp(y))
print(exp(y)/start_time)
rel_exp <- append(rel_exp, exp(y)/start_time)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
#for (x in 1:length(input_file[,1])){
for (x in 1:10){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
print(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
print(y)
print(exp(y))
test = exp(y)/start_time
print(test)
rel_exp <- append(rel_exp, test)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
#for (x in 1:length(input_file[,1])){
for (x in 1:10){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
print(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
#for (x in 1:length(input_file[,1])){
for (x in 1:10){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
print(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
print(exp[y])
test = exp[y]/start_time
print(test)
rel_exp <- append(rel_exp, test)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
}
rel_exp <- NULL
for (y in 1:time_point){
print(exp)
test = exp(y)/start_time
print(test)
rel_exp <- append(rel_exp, test)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
#for (x in 1:length(input_file[,1])){
for (x in 1:10){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
print(exp[y])
test = exp[y]/start_time
print(test)
rel_exp <- append(rel_exp, test)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
#for (x in 1:length(input_file[,1])){
for (x in 1:10){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
rel_exp <- append(rel_exp, exp[y]/start_time)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
#Title: Normalization
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, row.names=1, header=T)
###print_header###
cat("gr_id","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
for (x in 1:length(input_file[,1])){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:3]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[4:data_length]
exp <- as.numeric(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
rel_exp <- append(rel_exp, exp[y]/start_time)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel_normalized.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, header=T)
View(input_file)
#Title: Calc_relative_expression
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, header=T)
###print_header###
cat("gr_id","symbol","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
for (x in 1:length(input_file[,1])){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:4]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[5:data_length]
exp <- as.numeric(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
rel_exp <- append(rel_exp, exp[y]/start_time)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
#Title: Calc_relative_expression
#Auther: Naoto Imamachi
#ver: 1.0.0
#Date: 2015-10-07
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, header=T)
###print_header###
cat("gr_id","symbol","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
###Read_each_line###
for (x in 1:length(input_file[,1])){
data <- input_file[x,]
data_length <- length(data)
gene_infor <- as.vector(as.matrix(data[1:4]))
cat(gene_infor, sep="\t", file=output_path, append=T)
cat("\t", sep="", file=output_path, append=T)
exp <- data[5:data_length]
exp <- as.numeric(exp)
start_time <- exp[1]
if(start_time == 0){
cat(rep(0,time_point), sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
next
}
rel_exp <- NULL
for (y in 1:time_point){
rel_exp <- append(rel_exp, exp[y]/start_time)
}
cat(rel_exp, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
}
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel_normalized.fpkm_table',sep="")
###Load_input_file###
input_file = read.table(input_path, header=T)
###print_header###
cat("gr_id","symbol","accession_id","locus", sep="\t", file=output_path)
cat("\t", file=output_path, append=T)
hour_label <- NULL
for(x in hour){
hour_label <- append(hour_label, paste(x, unit, sep=""))
}
cat(hour_label, sep="\t", file=output_path, append=T)
cat("\n", sep="", file=output_path, append=T)
View(input_file)
input_file$header
input_file$head
head(input_file)
head(input_file[input_file$X0h,])
head(input_file[input_file$X0h>0,])
head(input_file[input_file$X0h>0,input_file$X1h>0])
head(input_file[input_file$X0h>0 & input_file$X1h>0,])
head(input_file[input_file$X0hr>0 & input_file$X1hr>0,])
library(data.table)
###Prepare_file_infor###
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel_normalized.fpkm_table',sep="")
###Load_input_file###
input_file = fread(input_path, header=T)
View(input_file)
hour <- c(0,1,2,4,8,12)
time_point <- length(hour)
unit <- "hr"
input_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel.fpkm_table',sep="")
output_path <- paste('C:/Users/Naoto/Documents/github/BRIC-seq_data_analysis/BridgeR/data/genes_RefSeq_result_mRNA_rel_normalized.fpkm_table',sep="")
###Load_input_file###
input_file = fread(input_path)
View(input_file)
View(input_file)
